# 需求文档（V2+ 功能 Backlog）

## 简介

本需求文档用于补充 `.kiro/specs/rss-reader-frontend/requirements.md` 的 MVP 范围之外的后续规划，参考 Inoreader 的成熟能力，并结合“个人提效 + 学习笔记自动化 + RAG 智能问答”的新设想，形成可迭代的功能清单。

## 产品方向（以个人提效为主）

### 目标

- **更像 Inoreader**：具备高效阅读必备能力（组织、过滤、搜索、批量、快捷键、导入导出）。
- **学习闭环**：阅读时做批注（疑问/例子/总结），阅读后自动生成结构化学习笔记。
- **知识可检索**：对已拉取的文章做语义检索与问答（RAG），可返回相似文章链接并回答问题。

### 暂不优先（可延后）

- 推荐流、社交分享、热门榜等增长向功能（除非后续目标变化）。

## 优先级说明

- **P0**：补齐阅读器核心能力（对齐 Inoreader 基本体验）
- **P1**：学习与标注增强（个人提效的关键差异化）
- **P2**：RAG/智能机器人（建立知识检索与问答能力）
- **P3**：平台化能力（账号/同步/多端/权限/企业特性等）

---

## P0：阅读器核心能力（Inoreader 对齐）

### 需求 1：OPML 导入/导出（订阅迁移）

**用户故事：** 作为用户，我希望能导入/导出 OPML，以便在不同 RSS 阅读器之间迁移订阅。

#### 验收标准

1. WHEN 用户上传 OPML 文件 THEN 系统 SHALL 解析订阅源、文件夹/分组信息并预览导入结果（含冲突与重复提示）
2. WHEN 用户确认导入 THEN 系统 SHALL 批量创建订阅源并保持原有分组结构
3. WHEN 用户导出 THEN 系统 SHALL 生成包含当前订阅源与分组结构的 OPML 文件

### 需求 2：订阅源分组/文件夹/排序（组织能力）

**用户故事：** 作为用户，我希望能将订阅源放入文件夹并排序，以便更高效地管理信息来源。

#### 验收标准

1. WHEN 用户创建/重命名/删除文件夹 THEN 系统 SHALL 更新侧边栏结构并持久化
2. WHEN 用户拖拽订阅源 THEN 系统 SHALL 支持在文件夹内/跨文件夹移动并保存排序
3. WHEN 用户点击文件夹 THEN 系统 SHALL 展示该文件夹下的文章聚合视图

### 需求 3：文章状态与批量操作（未读/已读/星标/稍后读）

**用户故事：** 作为用户，我希望对文章进行标记与批量操作，以便快速清理收件箱并保留重要内容。

#### 验收标准

1. WHEN 用户对文章执行“已读/未读/星标/取消星标/稍后读/取消稍后读” THEN 系统 SHALL 即时更新 UI 与计数并持久化
2. WHEN 用户在列表中多选文章 THEN 系统 SHALL 支持批量执行上述操作
3. WHEN 用户切换视图（未读/全部/星标/稍后读） THEN 系统 SHALL 正确过滤文章集合

### 需求 4：搜索与过滤（标题/摘要/全文）

**用户故事：** 作为用户，我希望能搜索并过滤文章，以便快速定位信息。

#### 验收标准

1. WHEN 用户输入关键词 THEN 系统 SHALL 支持按标题/摘要搜索，并在能力具备后支持全文搜索
2. WHEN 用户设置过滤条件（订阅源/文件夹/标签/状态/时间范围） THEN 系统 SHALL 正确筛选并可组合过滤
3. WHEN 用户保存查询 THEN 系统 SHALL 生成“保存的搜索/智能流（Smart Stream）”入口

### 需求 5：规则与智能流（Smart Stream / 自动化）

**用户故事：** 作为用户，我希望基于规则自动过滤/标记文章，以减少手动处理成本。

#### 验收标准

1. WHEN 用户创建规则（关键词/来源/域名/作者/正则等） THEN 系统 SHALL 支持动作（自动打标签、自动星标、自动标记已读、移动到某文件夹）
2. WHEN 新文章到达 THEN 系统 SHALL 自动执行匹配规则并记录命中日志（便于排查）
3. WHEN 用户打开智能流 THEN 系统 SHALL 展示规则命中的文章聚合视图

### 需求 6：阅读效率增强（快捷键/阅读模式/原文）

**用户故事：** 作为用户，我希望更高效地阅读与跳转，减少鼠标操作。

#### 验收标准

1. WHEN 用户使用快捷键（例如 j/k 上下篇、m 已读、s 星标、o 打开原文等） THEN 系统 SHALL 正确执行并可在设置中自定义
2. WHEN 用户切换阅读模式（沉浸模式/三栏/单栏/字体大小/行宽/主题） THEN 系统 SHALL 立即生效并持久化偏好
3. WHEN 用户打开原文 THEN 系统 SHALL 在新标签页打开，并保留阅读器中的状态一致性

---

## P1：分类、标签与学习闭环（个人提效核心）

### 需求 7：内容分类（信息媒体/学术/论坛/文档等）+ 自定义

**用户故事：** 作为用户，我希望将文章归类到不同信息类型，以便按“信息密度/可信度/用途”组织阅读。

#### 验收标准

1. WHEN 用户为文章/订阅源设置分类 THEN 系统 SHALL 支持单选或多选分类（根据产品决定）并可在列表中过滤
2. WHEN 用户管理分类体系 THEN 系统 SHALL 支持新增/合并/停用自定义分类
3. WHEN 分类缺失 THEN 系统 SHALL 提供“待分类”视图以便批处理

### 需求 8：标签系统（自定义标签 + AI 生成标签）

**用户故事：** 作为用户，我希望能给文章打标签，并让 AI 辅助生成标签，以便快速归档与检索。

#### 验收标准

1. WHEN 用户为文章添加/移除标签 THEN 系统 SHALL 即时更新并可批量操作
2. WHEN 用户触发“AI 生成标签” THEN 系统 SHALL 基于文章内容（可选包含标题/摘要/全文）生成候选标签，并允许用户勾选确认
3. WHEN AI 生成标签与现有标签冲突 THEN 系统 SHALL 提供合并/替换/忽略选项

### 需求 9：标注系统升级（高亮 + 批注类型）

**用户故事：** 作为用户，我希望在阅读时做可定位的标注与批注，并区分“疑问/例子/总结”等类型。

#### 验收标准

1. WHEN 用户选中文本 THEN 系统 SHALL 支持创建高亮并附加批注
2. WHEN 用户创建批注 THEN 系统 SHALL 支持类型（疑问/例子/总结/行动项/其他自定义）与标签
3. WHEN 文章内容变化或重新渲染 THEN 系统 SHALL 尽可能保持标注锚点稳定（提供失效提示与重新定位手段）
4. WHEN 用户在功能栏查看标注 THEN 系统 SHALL 支持按类型/时间/标签过滤与导出

### 需求 10：学习笔记自动生成（基于文章 + 我的批注）

**用户故事：** 作为用户，我希望阅读后 AI 自动生成学习笔记，减少资料搜集与整理成本。

#### 验收标准

1. WHEN 用户点击“生成学习笔记” THEN 系统 SHALL 使用文章内容 + 用户批注作为输入生成笔记
2. WHEN 笔记生成完成 THEN 系统 SHALL 输出结构化内容，至少包含：核心概念、关键要点、我的疑问清单、我的总结、可执行练习/实验
3. WHEN 用户设置“概念:实践 = 1:4”偏好 THEN 系统 SHALL 在输出篇幅与结构上体现该比例（例如实践占比更高：代码例子、操作步骤、练习任务）
4. WHEN 系统提供延伸阅读/材料 THEN 系统 SHALL 为每条材料提供来源链接与推荐理由（可后续接入网页检索）
5. WHEN 用户修改批注或参数 THEN 系统 SHALL 支持重新生成并保留历史版本对比/回滚

### 需求 11：可迁移的知识输出（Markdown/Obsidian/Notion）

**用户故事：** 作为用户，我希望将学习笔记与标注导出到常用知识库工具，形成长期积累。

#### 验收标准

1. WHEN 用户导出 THEN 系统 SHALL 支持 Markdown 导出（包含引用、链接、标签、时间）
2. WHEN 用户选择目标（Obsidian/Notion 等） THEN 系统 SHALL 提供兼容格式或集成方案（可先做手动导入友好）

---

## P2：基于已拉取 Feed 的 RAG 智能机器人

### 需求 12：语义检索（相似文章/主题聚类）

**用户故事：** 作为用户，我希望输入关键词或问题，就能找到相似文章链接，快速回顾相关内容。

#### 验收标准

1. WHEN 用户输入关键词/短语 THEN 系统 SHALL 返回按相似度排序的文章列表（含标题、来源、摘要、相似度）
2. WHEN 用户点击结果 THEN 系统 SHALL 打开对应阅读页并高亮命中片段（可选）
3. WHEN 用户筛选范围 THEN 系统 SHALL 支持限定订阅源/文件夹/标签/时间范围

### 需求 13：文章问答（RAG Chat，带引用）

**用户故事：** 作为用户，我希望对单篇或多篇文章提问，得到带引用依据的回答。

#### 验收标准

1. WHEN 用户在文章页提问 THEN 系统 SHALL 基于当前文章内容（及相关检索片段）生成回答，并输出引用位置/链接
2. WHEN 用户在全局机器人提问 THEN 系统 SHALL 在所有已入库文章中检索上下文并回答，同时返回引用文章列表
3. IF 检索不到足够信息 THEN 系统 SHALL 明确告知“不足以回答”并建议改写问题或扩大范围

### 需求 14：学习导向的对话能力（从问题到练习）

**用户故事：** 作为用户，我希望机器人不仅回答问题，还能把知识转化为可练习的任务与小实验。

#### 验收标准

1. WHEN 用户要求“给我练习/实验” THEN 系统 SHALL 生成可执行的 short lab（步骤、输入、预期输出、验收点）
2. WHEN 需要外部资料 THEN 系统 SHALL（在接入网页检索后）给出可点击的资料链接与筛选理由

---

## P3：兼容性、导入与同步（平台能力）

### 需求 15：手动导入文章（解决“拉取不到”的内容源）

**用户故事：** 作为用户，我希望能手动导入文章内容，避免被 RSS/抓取限制影响信息摄入。

#### 验收标准

1. WHEN 用户粘贴 URL THEN 系统 SHALL 尝试抓取与提取正文（可先提供后端接口占位）
2. WHEN 用户粘贴 Markdown/HTML/纯文本 THEN 系统 SHALL 创建一篇本地文章并进入阅读流程
3. WHEN 文章缺少标题 THEN 系统 SHALL 支持 AI 生成标题，并允许用户编辑确认

### 需求 16：账号与多设备同步（可选）

**用户故事：** 作为用户，我希望在多设备上同步订阅、阅读状态、标注与笔记。

#### 验收标准

1. WHEN 用户登录 THEN 系统 SHALL 同步订阅源、文章状态、标签、标注与笔记
2. WHEN 用户离线操作后恢复网络 THEN 系统 SHALL 支持冲突处理策略（时间优先/合并/手动选择）

---

## 开放问题（后续设计/技术验证）

1. **全文获取与安全**：是否允许渲染原始 HTML？如允许，需要明确净化/沙箱策略（XSS 风险）。
2. **标注锚点策略**：基于 DOM Range、文本定位（TextQuoteSelector）、或内容 hash 的稳定性权衡。
3. **RAG 存储与隐私**：Embedding/向量库放本地还是服务端？是否需要端到端加密？
4. **网页检索能力**：short lab 与延伸阅读若依赖网络检索，需要明确可用的搜索源与缓存策略。

