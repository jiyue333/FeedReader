# 实施计划

- [x] 1. 搭建项目基础架构
  - 使用 Vite + React + TypeScript 初始化项目
  - 配置 Tailwind CSS 和 Headless UI
  - 设置 React Router v6 路由
  - 配置 ESLint 和 Prettier
  - _需求: 所有需求的基础_

- [x] 2. 实现数据模型和 Mock 数据
  - 定义 Feed、Article、Note、ChatHistory 的 TypeScript 接口
  - 创建 Mock 订阅源数据（3-5 个示例订阅源）
  - 创建 Mock 文章数据（每个订阅源 10-20 篇文章，包含 Markdown 内容）
  - 创建 Mock AI 响应逻辑（基于关键词匹配）
  - _需求: 1.2, 1.3, 6.2, 6.4, 7.2_

- [x] 3. 实现本地存储服务
  - 创建 StorageService 接口和实现（基于 LocalStorage）
  - 实现 feeds、articles、notes、chatHistories 的 CRUD 操作
  - 实现数据序列化和反序列化
  - _需求: 1.2, 6.2, 6.4, 7.2_

- [ ]* 3.1 编写属性测试：笔记持久化往返一致性
  - **属性 16: 笔记持久化往返一致性**
  - **验证需求: 6.2, 6.4**

- [x] 4. 实现状态管理
  - 使用 Zustand 创建全局状态 store
  - 实现 feeds、articles 的状态管理 actions
  - 实现 activeFeedId 的 UI 状态管理
  - _需求: 2.1, 2.2, 3.1_

- [x] 5. 实现 Mock RSS 服务层
  - 创建 MockRSSService 类
  - 实现 validateFeedUrl 函数（简单的 URL 格式验证）
  - 实现 fetchFeed 函数（返回 mock 订阅源数据）
  - 实现 fetchArticles 函数（返回 mock 文章列表）
  - 实现 sendChatMessage 函数（返回 mock AI 响应）
  - 为所有异步方法添加延迟（200-800ms）模拟网络请求
  - _需求: 1.1, 1.2, 1.3, 7.2, 8.1_

- [ ]* 5.1 编写属性测试：URL 验证正确性
  - **属性 1: URL 验证正确性**
  - **验证需求: 1.1**

- [ ]* 5.2 编写属性测试：无效 URL 错误处理
  - **属性 4: 无效 URL 错误处理**
  - **验证需求: 1.4**

- [ ] 6. 实现订阅源管理功能
  - 创建 AddFeedButton 组件（输入框 + 添加按钮）
  - 实现添加订阅源的业务逻辑（验证、去重、保存到 LocalStorage）
  - 实现错误处理和用户提示（Toast 通知）
  - _需求: 1.1, 1.2, 1.4, 1.5_

- [ ]* 6.1 编写属性测试：添加订阅源的完整性
  - **属性 2: 添加订阅源的完整性**
  - **验证需求: 1.2, 1.3**

- [ ]* 6.2 编写属性测试：重复添加阻止
  - **属性 3: 重复添加阻止**
  - **验证需求: 1.5**

- [ ] 7. 实现侧边栏订阅源列表
  - 创建 Sidebar 组件
  - 创建 FeedList 和 FeedItem 组件
  - 实现订阅源列表渲染（标题、图标、未读计数）
  - 实现订阅源选择和高亮逻辑
  - 实现空状态提示
  - _需求: 2.1, 2.3, 2.4, 2.5_

- [ ]* 7.1 编写属性测试：订阅源列表完整性
  - **属性 5: 订阅源列表完整性**
  - **验证需求: 2.1**

- [ ]* 7.2 编写属性测试：未读计数准确性
  - **属性 6: 未读计数准确性**
  - **验证需求: 2.3**

- [ ]* 7.3 编写属性测试：未读状态视觉反馈
  - **属性 7: 未读状态视觉反馈**
  - **验证需求: 2.4**

- [ ] 8. 实现主页面文章列表
  - 创建 HomePage 组件（布局：侧边栏 + 文章列表）
  - 创建 ArticleList 组件
  - 创建 ArticleCard 组件（标题、摘要、来源、时间、已读状态）
  - 实现文章过滤逻辑（根据选中的订阅源）
  - 实现无限滚动或分页加载
  - _需求: 2.2, 3.1, 3.2, 3.3, 3.4_

- [ ]* 8.1 编写属性测试：文章过滤正确性
  - **属性 8: 文章过滤正确性**
  - **验证需求: 2.2, 3.1**

- [ ]* 8.2 编写属性测试：文章卡片内容完整性
  - **属性 9: 文章卡片内容完整性**
  - **验证需求: 3.2**

- [ ]* 8.3 编写属性测试：已读未读样式区分
  - **属性 10: 已读未读样式区分**
  - **验证需求: 3.4**

- [ ] 9. 实现文章导航和路由
  - 配置 /article/:articleId 路由
  - 实现 ArticleCard 点击导航逻辑
  - _需求: 3.5_

- [ ]* 9.1 编写属性测试：文章导航正确性
  - **属性 11: 文章导航正确性**
  - **验证需求: 3.5**

- [ ] 10. 实现阅读页面基础布局
  - 创建 ReaderPage 组件
  - 实现三栏布局（目录栏、内容区、功能栏）
  - 实现响应式宽度调整
  - _需求: 4.1, 4.2, 4.3, 4.4_

- [ ]* 10.1 编写属性测试：阅读页面布局完整性
  - **属性 12: 阅读页面布局完整性**
  - **验证需求: 4.1, 4.2, 4.3, 4.4**

- [ ] 11. 实现文章内容渲染
  - 创建 ArticleContent 组件
  - 集成 react-markdown 渲染 Markdown 内容
  - 配置 remark-gfm 和 rehype-raw 插件
  - 实现代码高亮和表格样式
  - _需求: 4.3_

- [ ] 12. 实现文章自动标记已读
  - 在 ReaderPage 加载时更新文章的 isRead 状态
  - 更新 LocalStorage 中的文章记录
  - 触发状态更新以刷新未读计数
  - _需求: 4.5_

- [ ]* 12.1 编写属性测试：打开文章自动标记已读
  - **属性 13: 打开文章自动标记已读**
  - **验证需求: 4.5**

- [ ] 13. 实现目录功能
  - 创建 TableOfContents 组件
  - 实现 Markdown 标题解析函数（提取 h1-h6）
  - 实现目录层级结构渲染
  - 实现目录项点击滚动到对应章节
  - 实现滚动时高亮当前目录项
  - 处理无标题文章的空状态
  - _需求: 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ]* 13.1 编写属性测试：标题解析正确性
  - **属性 14: 标题解析正确性**
  - **验证需求: 5.1**

- [ ]* 13.2 编写属性测试：目录点击滚动
  - **属性 15: 目录点击滚动**
  - **验证需求: 5.2**

- [ ] 14. 实现笔记功能
  - 创建 FunctionPanel 组件（Tab 切换：笔记/AI聊天）
  - 创建 NotesTab 和 NoteEditor 组件
  - 实现笔记输入和实时保存（防抖，保存到 LocalStorage）
  - 实现笔记加载（从 LocalStorage）
  - 实现文本选中添加到笔记的快捷操作
  - 实现清空笔记功能
  - _需求: 6.1, 6.2, 6.3, 6.4, 6.5_

- [ ]* 14.1 编写属性测试：笔记删除完整性
  - **属性 17: 笔记删除完整性**
  - **验证需求: 6.5**

- [ ] 15. 实现 AI 聊天界面
  - 创建 AIChatTab 组件
  - 创建 ChatMessage 和 ChatInput 组件
  - 实现聊天消息列表渲染
  - 实现发送消息和显示 Mock AI 响应（调用 MockRSSService.sendChatMessage）
  - 实现文本选中快捷提问功能
  - 实现加载状态和错误提示
  - 将聊天历史保存到 LocalStorage
  - _需求: 7.1, 7.2, 7.3, 7.4, 7.5_

- [ ]* 15.1 编写属性测试：AI 消息上下文完整性
  - **属性 18: AI 消息上下文完整性**
  - **验证需求: 7.2**

- [ ]* 15.2 编写属性测试：AI 响应显示正确性
  - **属性 19: AI 响应显示正确性**
  - **验证需求: 7.3**

- [ ]* 15.3 编写属性测试：AI 服务错误处理
  - **属性 20: AI 服务错误处理**
  - **验证需求: 7.5**

- [ ] 16. 实现刷新功能
  - 创建 RefreshButton 组件
  - 实现刷新所有订阅源的逻辑（调用 MockRSSService.fetchArticles）
  - 实现加载状态指示器
  - 实现新文章合并和去重逻辑
  - 实现刷新完成后更新未读计数
  - 实现错误处理
  - _需求: 8.1, 8.2, 8.3, 8.4, 8.5_

- [ ]* 16.1 编写属性测试：刷新请求完整性
  - **属性 21: 刷新请求完整性**
  - **验证需求: 8.1**

- [ ]* 16.2 编写属性测试：刷新加载状态
  - **属性 22: 刷新加载状态**
  - **验证需求: 8.2, 8.4**

- [ ]* 16.3 编写属性测试：新文章合并正确性
  - **属性 23: 新文章合并正确性**
  - **验证需求: 8.3**

- [ ]* 16.4 编写属性测试：刷新失败数据不变性
  - **属性 24: 刷新失败数据不变性**
  - **验证需求: 8.5**

- [ ] 17. 配置测试框架
  - 安装和配置 Vitest
  - 安装和配置 React Testing Library
  - 安装和配置 fast-check（属性测试库）
  - 创建测试工具函数和生成器
  - _需求: 所有需求的测试基础_

- [ ] 18. 实现错误处理和用户反馈
  - 创建 Toast 通知组件
  - 实现全局错误边界
  - 为所有异步操作添加错误处理
  - 实现网络错误、验证错误、存储错误的统一处理
  - _需求: 1.4, 1.5, 7.5, 8.5_

- [ ] 19. 性能优化
  - 实现文章列表虚拟滚动（使用 react-virtual）
  - 实现图片懒加载
  - 为搜索和笔记保存添加防抖
  - 配置 React Query 缓存策略
  - 实现代码分割（按路由）
  - _需求: 3.3（提升用户体验）_

- [ ] 20. 最终检查点
  - 确保所有测试通过，如有问题请询问用户
