# AnkiFlow 需求规范

## 1. 产品愿景与目标
- **一句话介绍**：一个以“RSS + PDF”为核心的智能阅读工作台，提供“多文档研读环境”，让用户在不切换软件的情况下完成深度阅读与结构化笔记。
- **核心假设**：**“持久化暂存区 + 混合源 RAG + 锚点综述”** 的工作流，能够显著提升从碎片阅读到可回溯研读产出的效率与质量。

## 2. 目标用户画像
- **技术专家**：需要快速对比新旧资料并形成观点，重视可回溯引用。
- **行业分析师**：需要整合多源信息（本地资料 + 网络新讯）并形成结构化报告。
- **研究生**：需要在文献阅读与笔记之间建立清晰的引用链路。

## 3. 核心用户流程（The “Deep Dive” Workflow）
1. 阅读 RSS 推送文章（文章 A）。
2. 在 AI 侧边栏开启“联网搜索”，询问概念。
3. AI 返回本地 PDF B 与网络网页 C 的引用结果，并标注来源。
4. 将 A、B、C 加入暂存区（持久化保存）。
5. 在暂存区勾选 A、B，排除低质量 C。
6. 点击“生成 Takeaway”，生成带全局编号的研读报告。
7. 未来阅读 B 时，看到关联的 Takeaway，并可点击引用跳回原文高亮段落。

## 4. 功能需求列表（按优先级）

### P0（MVP 核心，F1-F4）
- **F1 混合源 RAG**：支持本地知识库检索 + 外部网页搜索；AI 回答中按来源标识（[知识库]/[网络]）。
- **F2 持久化工作台**：暂存区与账号绑定，支持增删改查与勾选；跨会话持久化。
- **F3 锚点综述**：Takeaway 内包含精确到段落的引用锚点，点击可跳回原文高亮。
- **F4 双向关联**：文章详情页展示关联的 Takeaway 列表；笔记内展示引用文章。

### P1（v1.1 - v1.2 功能）
- **研读报告列表页**：支持按 ID/标签/关联文章检索历史 Takeaway。
- **Prompt 自定义**：可在设置中微调 Takeaway 生成模板（学术风格/通俗风格等）。
- **双向关联展示增强**：阅读页信息面板中列出关联 Takeaway 链接。
- **阅读进度记忆**：PDF/长文记住上次阅读位置。
- **URL 导入优化**：支持粘贴 URL 抓取全文（解决 RSS 摘要问题）。

### P2（v1.3 - v2.0 功能）
- **知识图谱可视化**：展示当前文章与暂存区/笔记的关系网。
- **智能高亮预测**：选中一句话时提供“找反义/找支持”等快捷菜单。
- **回顾模式（Spaced Repetition）**：基于 Takeaway 生成回顾卡片。
- **导出增强**：支持同步到 Notion/Obsidian（API 方式）。

## 5. 非功能性需求
- **性能**
  - 混合检索响应：常规查询 < 3s（不含 LLM 流式输出）。
  - PDF/URL 入库：单文档解析 < 10s（可异步）。
  - 阅读页加载：首屏内容 < 2s。
- **安全**
  - 用户数据隔离；API Key（Search/LLM）安全存储。
  - 访问控制：仅授权用户可访问其文档/笔记/暂存区。
- **可扩展性**
  - 模块化架构，保留扩展槽位（导出、插件、分享）。
  - 支持新增数据源与新的检索/LLM 提供商。

## 6. 不做事项（N1-N3）
- **N1**：复杂的 UI 拖拽式自定义布局。
- **N2**：多模态支持（图像/音频/视频）。
- **N3**：社交分享功能。
